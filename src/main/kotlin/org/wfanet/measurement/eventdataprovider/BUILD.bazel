"""
This library is exported to maven.
"""

load("@rules_jvm_external//:defs.bzl", "java_export")
load("@io_bazel_rules_kotlin//kotlin:jvm.bzl", "kt_jvm_library")
load(
    "//build:maven_deps.bzl",
    "cross_media_measurement_maven_deploy_env",
    "cross_media_measurement_maven_runtime_deps",
)

java_library(
    name = "all",
    resources = [
        "@any_sketch_java//src/main/java/org/wfanet/anysketch/crypto:libsketch_encrypter_adapter.so",
    ],
    runtime_deps = [
        "//imports/java/com/google:cel-generated-pb",
        "//imports/java/org/projectnessie/cel:core",
        "//imports/java/org/projectnessie/cel/tools",
        "//src/main/kotlin/org/wfanet/measurement/api/v2alpha:event_data_classes",
        "//src/main/kotlin/org/wfanet/measurement/api/v2alpha:event_templates",
        "//src/main/kotlin/org/wfanet/measurement/api/v2alpha:resource_key",
        "//src/main/kotlin/org/wfanet/measurement/eventdataprovider/eventfiltration:event_filters",
        "//src/main/kotlin/org/wfanet/measurement/eventdataprovider/privacybudgetmanagement:privacy_budget_manager",
        "//src/main/kotlin/org/wfanet/measurement/eventdataprovider/privacybudgetmanagement/api/v2alpha:privacy_query_mapper",
        "//src/main/proto/wfa/any_sketch:sketch_kt_jvm_proto",
        "//src/main/proto/wfa/any_sketch/crypto:sketch_encryption_methods_kt_jvm_proto",
        "//src/main/proto/wfa/measurement/api/v2alpha:certificates_service_kt_jvm_grpc_proto",
        "//src/main/proto/wfa/measurement/api/v2alpha:crypto_kt_jvm_proto",
        "//src/main/proto/wfa/measurement/api/v2alpha:event_group_kt_jvm_proto",
        "//src/main/proto/wfa/measurement/api/v2alpha:event_groups_service_kt_jvm_grpc_proto",
        "//src/main/proto/wfa/measurement/api/v2alpha:measurement_consumers_service_kt_jvm_grpc_proto",
        "//src/main/proto/wfa/measurement/api/v2alpha:measurements_service_kt_jvm_grpc_proto",
        "//src/main/proto/wfa/measurement/api/v2alpha:requisition_fulfillment_service_kt_jvm_grpc_proto",
        "//src/main/proto/wfa/measurement/api/v2alpha:requisitions_service_kt_jvm_grpc_proto",
        "//src/main/kotlin/org/wfanet/measurement/api/v2alpha:event_group_metadata_parser",
        "//src/main/kotlin/org/wfanet/measurement/kingdom/service/api/v2alpha:event_group_metadata_descriptors_service",
        "@any_sketch_java//src/main/java/org/wfanet/anysketch",
        "@any_sketch_java//src/main/java/org/wfanet/anysketch:sketch_proto_converter",
        "@any_sketch_java//src/main/java/org/wfanet/anysketch:estimators",
        "@any_sketch_java//src/main/java/org/wfanet/anysketch:value_histogram",
        "@any_sketch_java//src/main/java/org/wfanet/anysketch/crypto:sketch_encrypter_adapter",
        "@any_sketch_java//src/main/java/org/wfanet/sampling:vid_sampler",
        "@wfa_common_jvm//imports/java/com/google/cloud/bigquery",
        "@wfa_common_jvm//imports/kotlin/kotlinx/coroutines:core",
        "@wfa_common_jvm//src/main/kotlin/org/wfanet/measurement/common",
        "@wfa_common_jvm//src/main/kotlin/org/wfanet/measurement/common/crypto:key_storage",
        "@wfa_common_jvm//src/main/kotlin/org/wfanet/measurement/common/grpc",
        "@wfa_common_jvm//src/main/kotlin/org/wfanet/measurement/common/identity",
        "@wfa_common_jvm//src/main/kotlin/org/wfanet/measurement/common/throttler",
        "@wfa_common_jvm//src/main/kotlin/org/wfanet/measurement/storage:client",
        "@wfa_consent_signaling_client//src/main/kotlin/org/wfanet/measurement/consent/client/dataprovider",
        "@wfa_consent_signaling_client//src/main/kotlin/org/wfanet/measurement/consent/client/measurementconsumer",
        "//src/main/kotlin/org/wfanet/measurement/eventdataprovider/privacybudgetmanagement/deploy/postgres",
    ],
)

java_export(
    name = "maven-all",
    deploy_env = cross_media_measurement_maven_deploy_env(),
    maven_coordinates = "org.wfanet:cross-media-measurement-eventdataprovider-all:${TAG_NAME}",
    pom_template = "//deploy:pom_template.xml",
    tags = ["no-javadocs"],
    runtime_deps = [":all"] +
                   cross_media_measurement_maven_runtime_deps(),
)
